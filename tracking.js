function t(t){const e=`; ${document.cookie}`,n=e.split(`; ${t}=`);return 2===n.length?n.pop().split(";").shift():null}function e(){const t=new URLSearchParams(window.location.search);return{ttclid:t.get("ttclid"),fbclid:t.get("fbclid")}}function n(){let n=localStorage.getItem("sessionId");return n||(n=crypto.randomUUID(),localStorage.setItem("sessionId",n)),{sessionId:n,url:window.location.href,referrer:document.referrer,userAgent:navigator.userAgent,fbc:t("_fbc"),fbp:t("_fbp"),ttp:t("_ttp"),...e()}}export async function trackEvent(t,e={}){try{console.log(`Mempersiapkan pengiriman event '${t}'...`);const o={eventName:t,eventId:crypto.randomUUID(),eventData:{value:e.value??1,currency:e.currency??"IDR",contentType:e.contentType??"page",contents:e.contents??null,...e},clientInfo:n()},c=await fetch("https://psstmdfdoantnlmicvcp.supabase.co/functions/v1/events-log",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!c.ok)throw new Error(`Events Log API error: ${c.statusText}`);const r=await c.json();console.log(`✅ Event '${t}' berhasil:`,r)}catch(t){console.error("❌ Gagal mengirim event tracking:",t)}}
